Gu√≠a: Contrato Inteligente B√°sico en OneChain con Move
1. Escribir un contrato inteligente b√°sico en Move para OneChain

OneChain es un blockchain Layer-1 basado en Move, por lo que la sintaxis y estructura de los contratos es similar a Move en Sui/Aptos. Un ejemplo sencillo es un contrato de contador que permita crear e incrementar un valor, o un saludo que almacene un mensaje. A continuaci√≥n se muestra un m√≥dulo Move b√°sico de un contador:

module example::SharedCounter {
    struct Counter has key {
        id: UID,
        value: u64,
    }

    public fun create(): Counter {
        Counter { id: UID::new(), value: 0 }
    }

    public fun increment(counter: &mut Counter) {
        counter.value = counter.value + 1;
    }

    public fun get_value(counter: &Counter): u64 {
        counter.value
    }
}


Como se ve, definimos una estructura Counter como recurso (has key) con un campo value. La funci√≥n create inicializa un nuevo contador (valor 0) y la funci√≥n increment suma 1 al valor
sui.peera.ai
sui.peera.ai
. En un contrato real, estas funciones se marcar√≠an como public entry fun y utilizar√≠an el contexto de transacci√≥n (&mut TxContext o un &signer) para crear y registrar el recurso en la cadena. Por ejemplo, create_counter podr√≠a usar move_to(sender, Counter {...}) para mover el nuevo recurso al address del usuario, y increment_counter podr√≠a recibir una referencia mutable al objeto Counter que se desea actualizar.

Estructura del paquete Move: Organiza el c√≥digo en una carpeta de proyecto Move. Crea un archivo Move.toml en la ra√≠z del paquete (definiendo nombre del m√≥dulo y dependencias, como MoveStdlib de OneChain) y un directorio sources/ donde colocar el c√≥digo Move (por ejemplo, counter.move). Esta es la estructura t√≠pica para contratos Move en OneChain.

2. Configurar el entorno de desarrollo

Para desarrollar en OneChain necesitaremos instalar algunas herramientas y configurar nuestro entorno:

OneChain CLI: Es una herramienta de l√≠nea de comandos (similar a la de Sui) que permite compilar y publicar contratos Move en OneChain
github.com
. Inst√°lala desde la documentaci√≥n oficial de OneLabs (puede requerir compilar el c√≥digo fuente de OneChain o descargar un binario). Nota: OneChain CLI suele llamarse simplemente one. Aseg√∫rate de a√±adirla al PATH.

Node.js 18+ y npm: Se requieren para herramientas de frontend y scripts relacionados (por ejemplo, usar el SDK de TypeScript)
github.com
. Aseg√∫rate de tener Node.js ‚â• 18 instalado.

OneWallet (extensi√≥n de navegador): Es la billetera oficial de OneChain para firmar transacciones. Inst√°lala como extensi√≥n (desde la p√°gina oficial de OneChain) y crea/recupera una cuenta. La CLI tambi√©n permite generar direcciones, pero para la interacci√≥n con frontend necesitar√°s OneWallet
github.com
github.com
.

OCT (token nativo de OneChain) de pruebas: Las transacciones en OneChain consumen gas en OCT. Consigue OCT de Testnet usando el faucet oficial
github.com
. Por ejemplo, OneLabs ofrece un faucet en https://faucet-testnet.onelabs.cc 
github.com
. Aseg√∫rate de tener OCT en tu direcci√≥n de prueba para desplegar y usar el contrato.

Configuraci√≥n de red (Testnet): OneChain tiene diferentes redes (Local, Devnet, Testnet, Mainnet). Usaremos Testnet para este proyecto. La URL RPC p√∫blica de Testnet es https://rpc-testnet.onelabs.cc:443 
github.com
. Puedes exportarla en una variable de entorno o configurarla en tu aplicaci√≥n. Por ejemplo, en un proyecto web, podr√≠as definir:

NEXT_PUBLIC_ONECHAIN_RPC_URL=https://rpc-testnet.onelabs.cc:443
NEXT_PUBLIC_ONECHAIN_NETWORK=testnet


Esto apunta tu cliente al nodo p√∫blico de Testnet
github.com
. Nota: Los endpoints p√∫blicos de OneLabs tienen l√≠mite de 100 solicitudes/30s
doc-testnet.onelabs.cc
, suficientes para desarrollo. Para producci√≥n, considera usar tu propio nodo o un proveedor de RPC dedicado.

3. Compilar y desplegar el contrato en OneChain (CLI)

Con el c√≥digo Move escrito y el entorno listo, sigue estos pasos para compilar y publicar el contrato en la red de OneChain:

Compilaci√≥n del paquete Move: Navega a la carpeta de tu paquete Move y ejecuta:

one move build


Esto compilar√° tu c√≥digo Move y sus dependencias. Si hay errores de sintaxis o tipo, la CLI los indicar√°. Cuando compile sin errores, generar√° un bytecode listo para publicar
github.com
.

Publicaci√≥n en Testnet: Una vez compilado, despliega el paquete con:

one client publish --gas-budget 100000000


Este comando env√≠a una transacci√≥n de publicaci√≥n. --gas-budget 100000000 ajusta el gas m√°ximo en unidades de MIST (1 OCT = 10^9 MIST, similar a SUI)
github.com
. Ajusta el presupuesto seg√∫n la complejidad del paquete (100 millones de gas es usual para paquetes b√°sicos). La CLI usar√° tu cuenta (aseg√∫rate de haber inicializado una cuenta con one client previamente y tener OCT de gas).

Salida ‚Äì Package ID: Tras publicar, la CLI mostrar√° detalles de la transacci√≥n, incluyendo el Package ID (identificador √∫nico del paquete de contrato) en formato hexadecimal. Copia este Package ID, ya que identifica el contrato en OneChain
github.com
. Por ejemplo, ver√°s algo como ----- Package ID: 0x<hash> ----- en la salida. Ese ID es la direcci√≥n del m√≥dulo en la cadena.

Verificar el despliegue: Puedes comprobar que el contrato se public√≥ correctamente:

Usando la CLI: ejecuta one client objects para listar tus objetos en la cuenta, donde deber√° figurar el nuevo paquete
github.com
. Tambi√©n puedes ver la transacci√≥n con one client tx-block <TX_HASH>
github.com
.

Usando el explorador OneScan: Visita OneScan para Testnet en https://onescan.cc/testnet y busca por el Package ID o por el hash de la transacci√≥n
github.com
. OneScan permite inspeccionar el m√≥dulo publicado, sus funciones y tipos.

4. Obtener el Package ID y direcci√≥n del contrato

Tras la publicaci√≥n, el Package ID act√∫a como la direcci√≥n de tu contrato inteligente en OneChain. Necesitar√°s este ID para interactuar con el contrato (llamar funciones, etc.). Resume los datos necesarios:

Package ID: Identificador del paquete desplegado (p. ej. 0xabc123...). √ösalo para referenciar el m√≥dulo en las llamadas.

M√≥dulo y funciones: Dentro del paquete, tu c√≥digo define uno o m√°s m√≥dulos (por ejemplo, SharedCounter) y funciones p√∫blicas. Anota el nombre del m√≥dulo y de las funciones de entrada (entry fun) que quieras invocar.

IDs de objetos (si aplica): Si tu contrato crea objetos (como un recurso Counter), la publicaci√≥n del paquete no crea esos objetos; se crear√°n al invocar la funci√≥n correspondiente. Por ejemplo, tras llamar a create_counter, obtendr√°s un Object ID del contador creado. Necesitar√°s pasar ese ID al llamar funciones que requieran un objeto espec√≠fico (por ejemplo, para incrementar un contador espec√≠fico).

Ejemplo: Supongamos que el Package ID obtenido es 0x1234... y dentro de √©l est√° el m√≥dulo SharedCounter. Para crear un contador podr√≠as usar la CLI as√≠:

one client call \
  --package 0x1234... \
  --module SharedCounter \
  --function create \
  --args       \
  --gas-budget 50000000


La funci√≥n create() definida en Move retorna un nuevo objeto Counter. La CLI mostrar√° en la salida el Object ID creado (bajo "Created Objects"). Copia ese ID, p. ej. 0xABCD.... Luego, para incrementar el contador, har√≠as:

one client call \
  --package 0x1234... \
  --module SharedCounter \
  --function increment \
  --args [0xABCD...]    \
  --gas-budget 50000000


Aqu√≠ pasamos el Object ID del contador en los argumentos (notaci√≥n [objectID])
github.com
github.com
. La CLI tomar√° ese objeto (que debe pertenecer a tu cuenta o ser compartido) y ejecutar√° la funci√≥n increment. Cada llamada tambi√©n consumir√° gas OCT, as√≠ que verifica tener saldo suficiente.

5. Interactuar con el contrato desde un frontend (OneWallet + JavaScript)

Una vez el contrato est√° desplegado, podemos construir una peque√±a dApp frontend para interactuar con √©l. Utilizaremos OneWallet para firmar transacciones desde el navegador y el SDK de JavaScript/TypeScript de OneChain para facilitar la construcci√≥n de transacciones.

a. Instalar el SDK de OneChain: OneLabs provee paquetes NPM. Por ejemplo, instala el cliente de OneChain con:

npm install @onelabs/sui


(Nota: El paquete se llama sui porque est√° basado en la implementaci√≥n de Sui)
doc-testnet.onelabs.cc
. Este SDK nos permite conectarnos a nodos, construir transacciones Move y solicitar al wallet firmarlas.

b. Conectar OneWallet en la dApp: OneWallet es compatible con el Wallet Standard API (la misma interfaz que Sui Wallet). Puedes utilizar librer√≠as de Wallet Standard o acceder v√≠a window al objeto de OneWallet. Por simplicidad, asumiendo que el usuario tiene la extensi√≥n OneWallet instalada y una cuenta creada en Testnet:

Pide al usuario que conecte su OneWallet a tu aplicaci√≥n (por ejemplo, mediante un bot√≥n "Conectar"). Al hacerlo, OneWallet solicitar√° permiso y proporcionar√° la direcci√≥n p√∫blica.

Aseg√∫rate de que OneWallet est√© en la red de OneChain Testnet. Si no, solic√≠tale cambiar de red.

c. Construir y firmar una transacci√≥n: Para llamar una funci√≥n p√∫blica de tu contrato (por ejemplo, increment del m√≥dulo SharedCounter), crearemos una transacci√≥n Move. Usando el SDK:

import { SuiClient, getFullnodeUrl, Transaction } from '@onelabs/sui/client';

// Inicializar cliente RPC a Testnet
const client = new SuiClient({ url: getFullnodeUrl('testnet') });

// Datos del contrato
const packageId = "0x1234...";           // Package ID desplegado
const moduleName = "SharedCounter";      // Nombre del m√≥dulo
const functionName = "increment";        // Funci√≥n a invocar
const counterId = "0xABCD...";           // Object ID del Counter a incrementar

// Construir la transacci√≥n Move
const tx = new Transaction();
tx.moveCall({
    target: `${packageId}::${moduleName}::${functionName}`,
    arguments: [tx.object(counterId)]
});

// Pedir al wallet que firme y ejecute
const response = await wallet.signAndExecuteTransaction({
    transaction: tx,
    chain: 'onechain:testnet'
});
console.log("Tx Result:", response);


En el c√≥digo anterior, usamos Transaction.moveCall para especificar la llamada a increment(counter) pasando el ID del objeto. Luego invocamos wallet.signAndExecuteTransaction, que abrir√° OneWallet para que el usuario confirme la transacci√≥n
github.com
. Importante: OneWallet espera que le pasemos el objeto Transaction (no bytes sin procesar) y especificar correctamente la cadena 'onechain:testnet' en los par√°metros
github.com
. Si no, el bot√≥n de firmar podr√≠a quedar deshabilitado.

d. Manejar gas y ejecuci√≥n: OneWallet autom√°ticamente seleccionar√° la moneda de gas si la transacci√≥n est√° bien construida. No obstante, aseg√∫rate de preparar las monedas de gas adecuadamente. Por ejemplo, puedes usar el SDK para consultar tus monedas OCT (client.getCoins({ owner: address, coinType: '0x2::oct::OCT' })) y luego asignar una con tx.setGasPayment si necesitas control manual
github.com
. En muchos casos, para una sola transacci√≥n simple, no tendr√°s que hacerlo manualmente. Tras la firma, la wallet enviar√° la transacci√≥n a la red OneChain. Puedes verificar el resultado en la respuesta o en el explorador OneScan.

e. Ejemplo m√≠nimo de frontend: En una aplicaci√≥n React/Next.js podr√≠as crear un bot√≥n que al hacer clic ejecute la funci√≥n anterior. Por ejemplo:

<button onClick={incrementCounter}>Incrementar Contador</button>


Y la funci√≥n incrementCounter internamente construye la transacci√≥n como arriba y utiliza el objeto wallet obtenido al conectar OneWallet (p.ej., mediante window.oneWallet o usando @mysten/wallet-adapter). Recuerda siempre verificar que el usuario tiene OCT para pagar el gas y manejar posibles errores (transacci√≥n abortada, objeto no encontrado, etc.).

Resumen: Con OneWallet y el SDK de OneChain, la dApp puede invocar funciones p√∫blicas de tu contrato Move en el navegador de forma segura. OneWallet se encarga de firmar con la clave privada del usuario y proteger sus fondos. Aseg√∫rate de indicar la red correcta (Testnet) en las interacciones
github.com
 y de poblar correctamente los datos de gas y transacci√≥n antes de enviarla al wallet.

¬°Y eso es todo! Siguiendo estos pasos, habr√°s escrito un contrato Move b√°sico, lo habr√°s desplegado en OneChain Testnet y podr√°s interactuar con √©l desde un frontend web, listo para mostrar en el hackathon. üöÄ

Referencias: La gu√≠a se bas√≥ en la documentaci√≥n oficial de OneLabs y ejemplos de OneChain:

Documentaci√≥n de OneChain CLI y Quick Start
github.com
github.com

C√≥digo de ejemplo de contrato Move (contador)
sui.peera.ai
sui.peera.ai
